<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Association Tests &mdash; PangyPlot 0.1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="_static/favicon.svg"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Output" href="output.html" />
    <link rel="prev" title="Choosing Parameters" href="parameters.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            PangyPlot
              <img src="_static/pangyplot_logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="local_build.html">Local Build</a></li>
<li class="toctree-l1"><a class="reference internal" href="input.html">Input Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameters.html">Choosing Parameters</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Association Tests</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#common-single-variant-association-test">Common Single Variant Association Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rare-variant-association-test">Rare Variant Association Test</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#linear-test-cast-like">Linear Test (CAST-like)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quadratic-test-skat-like">Quadratic Test (SKAT-like)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#likelihood-method-coming-soon">Likelihood Method (Coming soon)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="output.html">Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="power_calculation.html">Power Simulation Package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PangyPlot</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Association Tests</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/tests.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="association-tests">
<span id="tests"></span><h1>Association Tests<a class="headerlink" href="#association-tests" title="Permalink to this heading">ÔÉÅ</a></h1>
<section id="common-single-variant-association-test">
<h2>Common Single Variant Association Test<a class="headerlink" href="#common-single-variant-association-test" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>For both quantitative and binary trait analyses, a common variant test refers to a score test which has a Chi-squared distribution with 1 degree of freedom under no association hypothesis. The general form of the score test appears as follows:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(T={{S^2} \over var(S)}\)</span></p>
</div></blockquote>
<p>Where \(T\) is the test statistic following a Chi-squared distribution and \(S\) is the score. This test is used to perform a genetic association analysis between the phenotype \(Y\) and a single variant \(G_j\). For testing variant \(j\) given \(n\) individuals and phenotype vector \(Y\) and genotype matrix \(G\),</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(S_j=\sum_{i=1}^n(Y_i-E(Y_i))G_{ij}\)</span></p>
<p><span class="math notranslate nohighlight">\(E(Y_i)=Y_i - \hat{Y}\)</span></p>
</div></blockquote>
<p>\(E(Y_i)\) is estimated from a vector of fitted values \(\hat{Y}\) which is dependent on the underlying distribution of \(Y\) (ex. case-control vs quantatitive). With no covariates, \(\hat{Y}=\bar{Y}\) which is the simple average of the observed phenotypes.</p>
<p>Under a case-control setting with no covariates, the score is an indication of how often the tested genotype appears in one group over the other. When coded as \(Y_i=1\) for cases and \(Y_i=0\) for controls, and genotypes coded as {0,1,2} corresponding to the number of alleles a particular individual possesses. Given this framework, cases with the allele of interest contribute positively to the overall score and controls contribute negatively. Therefore, the more a particular allele is associated with one group, the larger the magnitude of the score.</p>
<p>For genotypes coded strictly as {0,1,2}, the conventional variance formula is used to calculate \(var(S_j)\). To produce the test statistic \(T_j\), the square of the score \(S_j\) is normalized by the variance \(var(S_j)\) and a p-value is produced by evaluating \(T_j\) with respect to a Chi-squared distribution with 1 degree of freedom. In general, a large score and a small variance will result in a small (more significant) p-value.</p>
<p>In the vRVS methodology available in VikNGS, the genotype value \(G_{ij}\) is replaced with the expected genotype value calculated from the sequence read data \(E(G_{ikj}\mid D_{ikj})\). When integrating data from an arbitrary number of cohorts, the variance is calculated for each group separately and summed together to produce \(var(S_j)\). The details of the derivation of \(var(S_j)\) are given in the Supplementary document of the VikNGS paper <em>VIKNGS: A C++ Variant Integration Kit for next generation sequencing association analysis</em>.</p>
</section>
<section id="rare-variant-association-test">
<h2>Rare Variant Association Test<a class="headerlink" href="#rare-variant-association-test" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>For joint variant analysis, the score statistics for \(J\) variants, \(\boldsymbol{S}=[S_1,‚Ä¶,S_J]\). Please review the common variant section above to review the general structure of a score test. In VikNGS, multiple different genetic association tests are available which are described in the sections below.</p>
<p>For the CAST- and SKAT-like tests, we recommend the use of permutation to calculate p-values. This involves shuffling the phenotype vector \(Y\) and recalculating the p-value many times for every variant. After iteratively calculating a set of p-values, the final p-value is calculated based on the number of values that are less than or equal to the value that was calculated for the unshuffled data set divided by the number of iterations plus 1.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using permutation, the smallest p-value obtainable is 1/(# iterations + 1). Since this method can be very computationally expensive, an an early stopping procedure is available to terminate the calculation early if the p-value appears to be &gt; 0.05. This uses the method designed by Jiang and Salzman (2012 <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pubmed/23843675">üîó</a>).</p>
</div>
<p>When using expected genotypes and the vRVS methodology, the fact that data could be combined from multiple different cohorts prevents the use of a simple permutation test. Instead, the bootstrap approach defined by Derkach <em>et al</em>. (2012 <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pubmed/24733292">üîó</a>) was adopted the for binary trait (case-control) analysis. Given a matrix of expected genotypes, the mean genotype is subtracted from each matrix element and rows are selected at random with replacement to form a shuffled matrix. This is done for every group separately. Covariates are also bootstrapped independently from the genotypes.  For quantitative trait analysis using expected genotypes, we implement the permutation methodology defined by Lin and Tang (2011 <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3169821/">üîó</a>) within each combined group.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In VikNGS, these tests can be run by assuming the asymptotic distribution by setting the number of iterations to 1. Based on our limited testing, the results appear to behave as expected but we offer no statistical guarantees.</p>
</div>
<section id="linear-test-cast-like">
<h3>Linear Test (CAST-like)<a class="headerlink" href="#linear-test-cast-like" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>This test related to the CAST method described by Morgenthaler and Thilly (2007 <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pubmed/17101154">üîó</a>). In this test, a score vector of size \(J\) is calculated, each element corresponding to a different variant. Each score in the vector is calculated using the method described in the common variant section above. A single score value is produced by summing the elements of the score vector.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since this test uses a sum of scores, it is very powerful when all variants have the same directional impact on disease risk. Combining protective and harmful variants in the same test will result in severely reduced statistical power.</p>
</div>
</section>
<section id="quadratic-test-skat-like">
<h3>Quadratic Test (SKAT-like)<a class="headerlink" href="#quadratic-test-skat-like" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>This test related to the SKAT method described by Wu <em>et al</em>. (2011 <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3135811">üîó</a>). Similar to the linear test, a score vector of size \(J\) is calculated, each element corresponding to a different variant. Variants are weighted based on minor allele frequency (MAF): \(w^{1/2}=1/[MAF(1-MAF)]^{1/2}\). The p-value is calculated using the C++ code underlying the <a class="reference external" href="https://cran.r-project.org/web/packages/CompQuadForm/index.html">CompQuadForm</a> (Distribution Function of Quadratic Forms in Normal Variables) R library which is used in the R SKAT package.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method should be preferred over the linear test when both protective and harmful variants being collapsed together (of if it is unclear whether the variants are potentially protective or harmful).</p>
</div>
</section>
<section id="likelihood-method-coming-soon">
<h3>Likelihood Method (Coming soon)<a class="headerlink" href="#likelihood-method-coming-soon" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>This method refers to the test described in <em>Association testing for next-generation sequencing data using score statistics</em> _ from Skotte and Albrechtsen (2012 <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pubmed/22570057">üîó</a>) Their method provides a score test where genotype calls are substituted by their expected values, \(E(G_{ikj}\mid D_{ikj})\). The variance of the score test is obtained from the second derivative of the joint likelihood of the observed \(Y_i\) and the observed sequencing data, \(D_{ij}\) individual \(i\) at locus \(j\). The p-values are calculated using the asymptotic distribution of the score test. For a joint rare analysis of \(J\) variants, the score test is distributed as a chi-square distribution with \(J\) degrees of freedom.  This can also be used for common single variant association test which is distributed as chi-squared with one degree of freedom.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="parameters.html" class="btn btn-neutral float-left" title="Choosing Parameters" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="output.html" class="btn btn-neutral float-right" title="Output" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Scott Mastromatteo.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>